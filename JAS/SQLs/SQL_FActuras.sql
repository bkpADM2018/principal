Select * from (
Select 'TRANSFERIDO', FECDRE FECHA, CPORRE CPORTE, IDCARE ID, CCONRE CDRUBRO
from MERFL.MER711WF 
where DVCDRE = 'T'
and FECDRE >= 20140401 
and FECDRE <= 20140431
--and CPORRE= " & pCartaPorte
union
Select CASE 
        when FCRGR6 = 0 then CONCAT('REVERTIDO POR ', USERR6)
        when FCCMST < 5 then CONCAT('PROFORMA ', FCCMNR)
        when FCCMST = 5 then 'ESPERANDO OK AFIP'
        else  CONCAT('FACTURADO ', CONCAT(FCCMDV, CONCAT('-', FCCMNR)))
        end,
FECDR6 FECHA, CPORR6 CPORTE, IDCAR6 ID, CCONR6 CDRUBRO
from MERFL.MER711F6 A
left join TFFL.TF100F1 B on A.FCRGR6=B.FCRGNR
where DVCDR6 = 'T'
and FECDR6 >= 20140401 
and FECDR6 <= 20140431
) TABLA
order by FECHA, CPORTE, ID, CDRUBRO

/*
Select 'REVERTIDO', FECDR6 FECHA, CPORR6 CPORTE, IDCAR6 ID, CCONR6 CDRUBRO, 0, 0 
from MERFL.MER711F6
where DVCDR6 = 'T'
and FECDR6 >= 20140401 
and FECDR6 <= 20140431
and FCRGR6 = 0
union
Select 'PROFORMA', FECDR6 FECHA, CPORR6 CPORTE, IDCAR6 ID, CCONR6 CDRUBRO, FCCMDV, FCCMNR
from MERFL.MER711F6 A
inner join TFFL.TF100F1 B on A.FCRGR6=B.FCRGNR
where DVCDR6 = 'T'
and FECDR6 >= 20140401 
and FECDR6 <= 20140431
and FCRGR6 <> 0
and FCCMST < 5
union
Select 'AFIP', FECDR6 FECHA, CPORR6 CPORTE, IDCAR6 ID, CCONR6 CDRUBRO, FCCMDV, FCCMNR 
from MERFL.MER711F6 A
inner join TFFL.TF100F1 B on A.FCRGR6=B.FCRGNR
where DVCDR6 = 'T'
and FECDR6 >= 20140401 
and FECDR6 <= 20140431
and FCRGR6 <> 0
and FCCMST = 5
union
Select 'FACTURADO', FECDR6 FECHA, CPORR6 CPORTE, IDCAR6 ID, CCONR6 CDRUBRO, FCCMDV, FCCMNR 
from MERFL.MER711F6 A
inner join TFFL.TF100F1 B on A.FCRGR6=B.FCRGNR
where DVCDR6 = 'T'
and FECDR6 >= 20140401 
and FECDR6 <= 20140431
and FCRGR6 <> 0
and FCCMST > 5
